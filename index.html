<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Southern US Interactive Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
      #map {
        height: 100vh;
      }

      .state-label {
        font-size: 16px;
        font-weight: bold;
        color: #333;
        background: transparent;
        text-align: center;
      }

      .city-label {
        font-size: 13px;
        background: white;
        padding: 2px 5px;
        border-radius: 3px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
        color: #222;
      }

      /* Modal Styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
      }

      .modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 0;
        border-radius: 10px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        animation: modalSlideIn 0.3s ease;
      }

      @keyframes modalSlideIn {
        from {
          transform: translateY(-50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-header {
        background: linear-gradient(135deg, #0078a8, #005a7a);
        color: white;
        padding: 20px;
        border-radius: 10px 10px 0 0;
        text-align: center;
        position: relative;
      }

      .modal-header h2 {
        margin: 0;
        font-size: 24px;
      }

      .close {
        position: absolute;
        right: 20px;
        top: 20px;
        color: white;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        line-height: 1;
      }

      .close:hover {
        opacity: 0.7;
      }

      .modal-body {
        padding: 30px;
      }

      .flag-section {
        text-align: center;
        margin-bottom: 25px;
      }

      .state-flag {
        width: 120px;
        height: 80px;
        border: 2px solid #ddd;
        border-radius: 5px;
        object-fit: cover;
      }

      .description-section {
        margin-bottom: 25px;
      }

      .description-section h3 {
        color: #0078a8;
        margin-bottom: 10px;
        font-size: 18px;
      }

      .description-section p {
        line-height: 1.6;
        color: #444;
        margin: 0;
      }

      .music-section {
        margin-bottom: 30px;
      }

      .music-section h3 {
        color: #0078a8;
        margin-bottom: 10px;
        font-size: 18px;
      }

      .music-section p {
        line-height: 1.6;
        color: #444;
        margin: 0;
      }

      .cta-section {
        text-align: center;
      }

      .cta-button {
        background: linear-gradient(135deg, #ff6b35, #f7931e);
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 16px;
        border-radius: 25px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        font-weight: bold;
      }

      .cta-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(255, 107, 53, 0.4);
      }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <!-- State Info Modal -->
    <div id="stateModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <span class="close">&times;</span>
          <h2 id="modalTitle">State Name</h2>
        </div>
        <div class="modal-body">
          <div class="flag-section">
            <img id="stateFlag" class="state-flag" src="" alt="State Flag" />
          </div>
          <div class="description-section">
            <h3>About</h3>
            <p id="stateDescription"></p>
          </div>
          <div class="music-section">
            <h3>Musical Heritage</h3>
            <p id="stateMusic"></p>
          </div>
          <div class="cta-section">
            <button id="ctaButton" class="cta-button">Plan Your Visit</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Leaflet + TopoJSON -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/topojson-client@3"></script>

    <script>
      // Create locked map view
      const map = L.map("map", {
        minZoom: 5,
        maxZoom: 7,
        zoomControl: false,
        dragging: true,
        scrollWheelZoom: false,
        doubleClickZoom: false,
        boxZoom: false,
        keyboard: false,
        maxBounds: [
          [24, -105], // SW
          [37, -75], // NE
        ],
      }).setView([31, -87], 6);

      // Label-free base map
      L.tileLayer(
        "https://{s}.basemaps.cartocdn.com/rastertiles/light_nolabels/{z}/{x}/{y}{r}.png",
        {
          attribution: "&copy; OpenStreetMap contributors",
        }
      ).addTo(map);

      // Define state data globally so modal functions can access it
      const stateNames = {
        1: "Alabama",
        12: "Florida",
        13: "Georgia",
        22: "Louisiana",
        45: "South Carolina",
        48: "Texas",
      };

      // Comprehensive state data for modal
      const stateData = {
        1: {
          name: "Alabama",
          flag: "https://upload.wikimedia.org/wikipedia/commons/5/5c/Flag_of_Alabama.svg",
          description:
            "Known as the Heart of Dixie, Alabama is famous for its rich Civil Rights history, beautiful Gulf Coast beaches, and southern hospitality.",
          music:
            "Alabama is the birthplace of the legendary country group Alabama and has deep roots in country, blues, and gospel music, with cities like Muscle Shoals being iconic recording destinations that helped shape Southern rock and country music.",
        },
        12: {
          name: "Florida",
          flag: "https://upload.wikimedia.org/wikipedia/commons/f/f7/Flag_of_Florida.svg",
          description:
            "The Sunshine State offers year-round warmth, world-famous theme parks, pristine beaches, and the unique culture of the Everglades.",
          music:
            "Florida's music scene blends country with Latin influences and is home to influential country artists like Jake Owen and Chris Young, while also fostering the development of Southern rock through bands like Lynyrd Skynyrd.",
        },
        13: {
          name: "Georgia",
          flag: "https://upload.wikimedia.org/wikipedia/commons/5/54/Flag_of_Georgia_%28U.S._state%29.svg",
          description:
            "Georgia combines historic charm with modern innovation, featuring Atlanta's bustling culture, Savannah's antebellum architecture, and the scenic Blue Ridge Mountains.",
          music:
            "Georgia has produced legendary country music stars like Alan Jackson and Travis Tritt, and Atlanta has become a major hub for both country and Southern rock music, with a thriving live music scene.",
        },
        22: {
          name: "Louisiana",
          flag: "https://upload.wikimedia.org/wikipedia/commons/e/e0/Flag_of_Louisiana.svg",
          description:
            "Louisiana captivates visitors with its unique Creole and Cajun culture, world-renowned cuisine, vibrant festivals, and the historic charm of New Orleans.",
          music:
            "While famous for jazz and blues, Louisiana has a rich country music heritage with zydeco influences and has produced country stars like Tim McGraw, blending traditional country with the state's unique cultural rhythms.",
        },
        45: {
          name: "South Carolina",
          flag: "https://upload.wikimedia.org/wikipedia/commons/6/69/Flag_of_South_Carolina.svg",
          description:
            "South Carolina offers stunning coastal beauty, historic Charleston, beautiful plantations, and a perfect blend of Southern tradition and coastal living.",
          music:
            "South Carolina has contributed significantly to country music with artists like Darius Rucker (formerly of Hootie & the Blowfish) and has a strong bluegrass tradition that influences modern country music throughout the region.",
        },
        48: {
          name: "Texas",
          flag: "https://upload.wikimedia.org/wikipedia/commons/f/f7/Flag_of_Texas.svg",
          description:
            "Everything's bigger in Texas, from its sprawling cities and vast landscapes to its rich cowboy heritage, barbecue culture, and independent spirit.",
          music:
            "Texas is arguably the heart of country music, producing legends like Willie Nelson, George Strait, and Miranda Lambert, and fostering the distinctive Texas country and Red Dirt music scenes that continue to influence country music worldwide.",
        },
      };

      // Modal functionality - define before the fetch
      const modal = document.getElementById("stateModal");
      const closeBtn = document.getElementsByClassName("close")[0];

      function openStateModal(stateId) {
        const state = stateData[stateId];
        if (!state) return;

        // Populate modal content
        document.getElementById("modalTitle").textContent = state.name;
        document.getElementById("stateFlag").src = state.flag;
        document.getElementById("stateFlag").alt = `Flag of ${state.name}`;
        document.getElementById("stateDescription").textContent =
          state.description;
        document.getElementById("stateMusic").textContent = state.music;
        document.getElementById(
          "ctaButton"
        ).textContent = `Plan Your Visit to ${state.name}`;

        // Show modal
        modal.style.display = "block";
      }

      function closeModal() {
        modal.style.display = "none";
      }

      // Event listeners
      closeBtn.onclick = closeModal;

      window.onclick = function (event) {
        if (event.target === modal) {
          closeModal();
        }
      };

      document.getElementById("ctaButton").onclick = function () {
        const stateName = document.getElementById("modalTitle").textContent;
        alert(
          `Planning your visit to ${stateName}! This would redirect to a travel planning service.`
        );
      };

      // Load low-fidelity US state shapes
      fetch("https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json")
        .then((res) => res.json())
        .then((topoData) => {
          const geojson = topojson.feature(topoData, topoData.objects.states);

          const stateCentroids = {
            1: [32.5, -86.8],
            12: [28.6, -82.5],
            13: [32.6, -83.5],
            22: [31.0, -92.0],
            45: [33.8, -80.9],
            48: [31.0, -99.0],
          };

          L.geoJSON(geojson, {
            filter: (feature) => Object.keys(stateNames).includes(feature.id),
            style: {
              color: "#0078A8",
              weight: 2,
              fillOpacity: 0.1,
            },
            onEachFeature: (feature, layer) => {
              layer.on("click", () => {
                openStateModal(feature.id);
              });
              layer.bindPopup(stateNames[feature.id]);
            },
          }).addTo(map);

          // Add state labels
          for (const id in stateCentroids) {
            L.marker(stateCentroids[id], {
              icon: L.divIcon({
                className: "state-label",
                html: stateNames[id],
                iconSize: [100, 20],
              }),
            }).addTo(map);
          }

          // Add manually-specified cities
          const cities = [
            { name: "Mobile, AL", coords: [30.6954, -88.0399] },
            { name: "Savannah, GA", coords: [32.0809, -81.0912] },
            { name: "New Orleans, LA", coords: [29.9511, -90.0715] },
            { name: "Tallahassee, FL", coords: [30.4383, -84.2807] },
            { name: "Charleston, SC", coords: [32.7765, -79.9311] },
            { name: "El Paso, TX", coords: [31.7619, -106.485] },
          ];

          cities.forEach((city) => {
            L.marker(city.coords, {
              icon: L.divIcon({
                className: "city-label",
                html: city.name,
                iconSize: [100, 20],
              }),
            }).addTo(map);
          });
        });
    </script>
  </body>
</html>
